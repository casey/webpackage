<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Web Packaging</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Use Cases">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Why not ZIP?">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 The Need for Standardization">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Format">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Mode of specification">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Top-level structure">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 From the end">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 From the beginning">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Parsing the index">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Parsing the manifest">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Sub-packages">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Parsing a resource">
<link href="#rfc.section.3" rel="Chapter" title="3 Guidelines for package authors">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Internet Media Type Registration">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.31.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Yasskin, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-yasskin-dispatch-web-packaging-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-09-30" />
  <meta name="dct.abstract" content="Web Packages provide a way to bundle up groups of web resources to transmit them together. These bundles can be signed to establish their authenticity." />
  <meta name="description" content="Web Packages provide a way to bundle up groups of web resources to transmit them together. These bundles can be signed to establish their authenticity." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">J. Yasskin</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">September 30, 2019</td>
</tr>
<tr>
<td class="left">Expires: April 2, 2020</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Web Packaging<br />
  <span class="filename">draft-yasskin-dispatch-web-packaging-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Web Packages provide a way to bundle up groups of web resources to transmit them together. These bundles can be signed to establish their authenticity.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 2, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Use Cases</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Why not ZIP?</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">The Need for Standardization</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Format</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Mode of specification</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Top-level structure</a>
</li>
<ul><li>2.2.1.   <a href="#rfc.section.2.2.1">From the end</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">From the beginning</a>
</li>
</ul><li>2.3.   <a href="#rfc.section.2.3">Parsing the index</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Parsing the manifest</a>
</li>
<ul><li>2.4.1.   <a href="#rfc.section.2.4.1">Sub-packages</a>
</li>
</ul><li>2.5.   <a href="#rfc.section.2.5">Parsing a resource</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Guidelines for package authors</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Internet Media Type Registration</a>
</li>
</ul><li>6.   <a href="#rfc.references">References</a>
</li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#problems" id="problems">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">People would like to use content offline and in other situations where there isn&#8217;t a direct connection to the server where the content originates. However, it&#8217;s difficult to distribute and verify the authenticity of applications and content without a connection to the network. The W3C has addressed running applications offline with Service Workers (<a href="#ServiceWorkers" class="xref">[ServiceWorkers]</a>), but not the problem of distribution.</p>
<p id="rfc.section.1.p.2">We&#8217;ve started work on this problem in <span>&lt;</span><a href="https://github.com/WICG/webpackage">https://github.com/WICG/webpackage</a><span>&gt;</span>, but we suspect that the IETF may be the right place to standardize the overall format. More details can be found in that repository.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#use-cases" id="use-cases">Use Cases</a>
</h1>
<p id="rfc.section.1.1.p.1">See <a href="#I-D.yasskin-webpackage-use-cases" class="xref">[I-D.yasskin-webpackage-use-cases]</a>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#not-zip" id="not-zip">Why not ZIP?</a>
</h1>
<p><a href="https://github.com/WICG/webpackage/issues/45">WICG/webpackage#45</a></p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#need" id="need">The Need for Standardization</a>
</h1>
<p id="rfc.section.1.3.p.1">Publishers and readers should be able to generate a package once, and have it usable by all browsers.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#Terminology" id="Terminology">Terminology</a>
</h1>
<p id="rfc.section.1.4.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#format" id="format">Format</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#mode" id="mode">Mode of specification</a>
</h1>
<p id="rfc.section.2.1.p.1">This specification defines how conformant web package parsers convert a sequence of bytes into the semantics of a web package. It does not constrain how web package encoders produce such a package: although there are some guidelines in <a href="#authoring-guidelines" class="xref">Section 3</a>, encoders MAY produce any sequence of bytes that a conformant parser would parse into the intended semantics.</p>
<p id="rfc.section.2.1.p.2">In places, this specification says the parser &#8220;MAY return&#8221; some data. This indicates that the described data is complete enough that later parsing failures do not need to discard it.</p>
<p id="rfc.section.2.1.p.3">In places, this specification says the parser &#8220;MUST fail&#8221;. The parser MAY report these failures to its caller in any way, but MUST NOT return any data it has parsed so far that wasn&#8217;t mentioned in a &#8220;MAY return&#8221; statement.</p>
<p id="rfc.section.2.1.p.4">This specification creates local variables with the phrase &#8220;Let <em>variable-name</em> be &#8230;&#8221;. Use of a variable before it&#8217;s created is a defect in this specification.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#top-level" id="top-level">Top-level structure</a>
</h1>
<p id="rfc.section.2.2.p.1">The package is roughly a CBOR item with the following CDDL schema, but package parsers are required to successfully parse some byte strings that aren&#8217;t valid CBOR. For example, sections may have padding between them, or even overlap, as long as the embedded relative offsets cause the parsing algorithm in this specification to return data.</p>
<pre>
webpackage = [
  ; &#127760;&#128230; in UTF-8.
  magic1: h'F0 9F 8C 90 F0 9F 93 A6',
  section-offsets: { * (($section-name .within tstr) =&gt; uint) },
  sections: [ *$section ],
  length: uint,  ; Total number of bytes in the package.
  ; &#127760;&#128230; in UTF-8.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',
]

$section-name /= "indexed-content" / "manifest"

$section /= indexed-content / signed-manifest

indexed-content = [index, [*response]]
</pre>
<p id="rfc.section.2.2.p.2">The parser MAY begin parsing at either the <a href="#from-start" class="xref">beginning</a> or <a href="#from-end" class="xref">end</a> of the byte string representing the package. Parsing from the end is useful when the package is embedded in another format such as a self-extracting executable, while parsing from the beginning is useful when loading from a stream.</p>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> <a href="#from-end" id="from-end">From the end</a>
</h1>
<p id="rfc.section.2.2.1.p.1">To parse from the end, the parser MUST load the last 18 bytes as the following <a href="#CDDL" class="xref">[CDDL]</a> group in array context: <a id="ednote-loading-cddl" class="info">[ednote-loading-cddl]<span class="info">jyasskin: CDDL doesn&#8217;t actually define how to use it as a schema to load CBOR data.</span></a></p>
<pre>
tail = (
  ; Total number of bytes in the package.
  length: uint,
  ; &#127760;&#128230; in UTF-8.
  magic2: h'F0 9F 8C 90 F0 9F 93 A6',
)
</pre>
<p id="rfc.section.2.2.1.p.2">If the bytes don&#8217;t match this group or these two CBOR items don&#8217;t occupy exactly 18 bytes, parsing MUST fail.</p>
<p id="rfc.section.2.2.1.p.3">Otherwise, continue as if the byte <samp>length</samp> bytes before the end of the string were the beginning of the package, and the parser were a <a href="#from-start" class="xref">from the beginning</a> parser.</p>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> <a href="#from-start" id="from-start">From the beginning</a>
</h1>
<p id="rfc.section.2.2.2.p.1">If the first 10 bytes of the package are not &#8220;85 48 F0 9F 8C 90 F0 9F 93 A6&#8221; (the CBOR encoding of the 5-item array header and 8-byte bytestring header, followed by &#127760;&#128230; in UTF-8), parsing MUST fail.</p>
<p id="rfc.section.2.2.2.p.2">Parse one CBOR item starting at the 11th byte of the package. If this does not match the CDDL</p>
<pre>
section-offsets = { * tstr =&gt; uint },
</pre>
<p id="rfc.section.2.2.2.p.3">or it is not a Canonical CBOR item (Section 3.9 of <a href="#CBOR" class="xref">[CBOR]</a>), parsing MUST fail.</p>
<p id="rfc.section.2.2.2.p.4">Let <em>sections-start</em> be the offset of the byte after the <samp>section-offsets</samp> item.  For example, if <samp>section-offsets</samp> were 52 bytes long, <em>sections-start</em> would be 63.</p>
<p id="rfc.section.2.2.2.p.5">This specification defines two section names: &#8220;indexed-content&#8221; and &#8220;manifest&#8221;.</p>
<p id="rfc.section.2.2.2.p.6">If <samp>section-offsets</samp>[&#8220;indexed-content&#8221;] is not present, parsing MUST fail.</p>
<p id="rfc.section.2.2.2.p.7">The parser MUST ignore unknown keys in the <samp>section-offsets</samp> map because new sections may be defined in future specifications.  <a id="ednote-critical-sections" class="info">[ednote-critical-sections]<span class="info">jyasskin: Do we need to mark critical section names?</span></a></p>
<p id="rfc.section.2.2.2.p.8">Let <em>index</em> be the result of parsing the bytes starting at offset <em>sections-start</em> + <samp>section-offsets</samp>[&#8220;indexed-content&#8221;] using the instructions in <a href="#index" class="xref">Section 2.3</a>.</p>
<p id="rfc.section.2.2.2.p.9">If <samp>section-offsets</samp>[&#8220;manifest&#8221;] is present, let <em>manifest</em> be the result of parsing the bytes starting at offset <em>sections-start</em> + <samp>section-offsets</samp>[&#8220;manifest&#8221;] using the instructions in <a href="#manifest" class="xref">Section 2.4</a>.</p>
<p id="rfc.section.2.2.2.p.10">The parser MAY return a semantic package consisting of <em>index</em>, and, if initialized, <em>manifest</em>.</p>
<p id="rfc.section.2.2.2.p.11">To parse each resource described within <em>index</em>, the parser MUST follow the instructions in <a href="#resource" class="xref">Section 2.5</a>.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#index" id="index">Parsing the index</a>
</h1>
<p id="rfc.section.2.3.p.1">The main content of a package is an index of HTTP requests pointing to HTTP responses. These request/response pairs hold the manifests of sub-packages and the resources in the package and all of its sub-packages. Both the requests and responses can appear in any order, usually chosen to optimize loading while the package is streamed.</p>
<p id="rfc.section.2.3.p.2">To parse the index, starting at offset <em>index-start</em>, the parser MUST do the following:</p>
<p id="rfc.section.2.3.p.3">If the byte at <em>index-start</em> is not 0x82 (the <a href="#CBOR" class="xref">[CBOR]</a> header for a 2-element array), the parser MUST fail.</p>
<p id="rfc.section.2.3.p.4">Load a CBOR item starting at <em>index-start</em> + 1 as the <samp>index</samp> array in the following CDDL:</p>
<pre>
index = [* [resource-key: http-headers,
            offset: uint,
            ? length: uint] ]

; http-headers is a byte string in HPACK format (RFC7541).
http-headers = bstr
</pre>
<p id="rfc.section.2.3.p.5">If the item doesn&#8217;t match this CDDL, or it is not a Canonical CBOR item (Section 3.9 of <a href="#CBOR" class="xref">[CBOR]</a>), the parser MUST fail.</p>
<p id="rfc.section.2.3.p.6">Let <em>resources-start</em> be the offset immediately after the <samp>index</samp> item. For example, if <em>index-start</em> were 75 and the <samp>index</samp> item were 105 bytes long, <em>resources-start</em> would be 75+1+105=181. (1 for the 0x82 array header.)</p>
<p id="rfc.section.2.3.p.7">Decode all of the <samp>resource-key</samp>s using <a href="#HPACK" class="xref">[HPACK]</a>, with an initially-empty dynamic table for each one.  <a id="ednote-compression" class="info">[ednote-compression]<span class="info">jyasskin: This spec has different security constraints from the ones that drove HPACK, so we may be able to do better with another compression format.</span></a> The decoded <samp>resource-key</samp>s are header lists (<a href="#HPACK" class="xref">[HPACK]</a>, Section 1.3), ordered lists of name-value pairs.</p>
<p id="rfc.section.2.3.p.8">The parser MUST fail if any of the following is true:</p>
<p></p>

<ol>
<li>HPACK decoding encountered an error.</li>
<li>Any <samp>resource-key</samp>&#8217;s first three headers are not named &#8220;:scheme&#8221;, &#8220;:authority&#8221;, and &#8220;:path&#8221;, in that order. Note that &#8220;:method&#8221; is intentionally omitted because only the GET method is meaningful.</li>
<li>Any of the pseudo-headers&#8217; values violates a requirement in Section 8.1.2.3 of <a href="#HTTP2" class="xref">[HTTP2]</a>.</li>
<li>Any <samp>resource-key</samp> has a non-pseudo-header name that includes the &#8220;:&#8221; character or is not lower-case ascii (<a href="#HTTP2" class="xref">[HTTP2]</a>, Section 8.1.2).</li>
<li>Any two decoded <samp>resource-key</samp>s are the same. Note that header lists with the same header fields in a different order are not the same.</li>
</ol>
<p id="rfc.section.2.3.p.10">Increment all <samp>offset</samp>s by <em>resources-start</em>.</p>
<p id="rfc.section.2.3.p.11">Return the resulting <samp>index</samp>, an array of decoded-resource-key, adjusted-offset, and optional-length triples.</p>
<p id="rfc.section.2.3.p.12">The optional <samp>length</samp> field in the index entries is redundant with the length prefixes on the <samp>response-headers</samp> and <samp>body</samp> in the content, but it can be used to issue Range requests <a href="#RFC7233" class="xref">[RFC7233]</a> for responses that appear late in the content.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#manifest" id="manifest">Parsing the manifest</a>
</h1>
<p id="rfc.section.2.4.p.1">A package&#8217;s manifest contains some metadata for the package; hashes, used in <a href="#hashing-resources" class="xref">Section 2.5, Paragraph 9</a>, for all resources included in that package; and validity information for any <a href="#subpackages" class="xref">sub-packages</a> the package depends on. The manifest is signed, so that UAs can trust that it comes from its claimed origin.  <a id="ednote-manifest-name" class="info">[ednote-manifest-name]<span class="info">jyasskin: This section doesn&#8217;t describe a manifest (https://www.merriam-webster.com/dictionary/manifest#h3), so consider renaming it to something like &#8220;authenticity&#8221;.</span></a></p>
<p id="rfc.section.2.4.p.2">To parse a manifest starting at <em>manifest-start</em>, a parser MUST do the following:</p>
<p id="rfc.section.2.4.p.3">Load one CBOR item starting at <em>manifest-start</em> as a <samp>signed-manifest</samp> from the following CDDL:</p>
<pre>
signed-manifest = {
  manifest: manifest,
  certificates: [+ certificate],
  signatures: [+ signature]
}

manifest = {
  metadata: manifest-metadata,
  resource-hashes: {* hash-algorithm =&gt; [hash-value]},
  ? subpackages: [* subpackage],
}

manifest-metadata = {
  date: time,
  origin: uri,
  * tstr =&gt; any,
}

; From https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm.
hash-algorithm /= "sha256" / "sha384" / "sha512"
; Note that a hash value is not base64-encoded, unlike in CSP.
hash-value = bstr

; X.509 format; see https://tools.ietf.org/html/rfc5280
certificate = bstr

signature = {
  ; This is the index of the certificate within the
  ; certificates array to use to validate the signature.
  keyIndex: uint,
  signature: bstr,
}
</pre>
<p id="rfc.section.2.4.p.4">If the item doesn&#8217;t match the CDDL or it&#8217;s not a Canonical CBOR item (Section 3.9 of <a href="#CBOR" class="xref">[CBOR]</a>), parsing MUST fail.</p>
<p id="rfc.section.2.4.p.5">Parse the elements of <samp>certificates</samp> as X.509 certificates within the <a href="#RFC5280" class="xref">[RFC5280]</a> profile. If any certificate fails to parse, parsing MUST fail.</p>
<p id="rfc.section.2.4.p.6">Let <em>message</em> be the concatenation of the following byte strings. This matches the <a href="#TLS1.3" class="xref">[TLS1.3]</a> format to avoid cross-protocol attacks when TLS certificates are used to sign manifests.</p>
<p></p>

<ol>
<li>A string that consists of octet 32 (0x20) repeated 64 times.</li>
<li>A context string: the ASCII encoding of &#8220;Web Package Manifest&#8221;.</li>
<li>A single 0 byte which serves as a separator.</li>
<li>The bytes of the <samp>manifest</samp> CBOR item.</li>
</ol>
<p id="rfc.section.2.4.p.8">Let <em>signing-certificates</em> be an empty array.</p>
<p id="rfc.section.2.4.p.9">For each element <em>signature</em> of <samp>signatures</samp>:</p>
<p></p>

<ol>
<li>Let <em>certificate</em> be <samp>certificates</samp>[<em>signature</em>[&#8220;keyIndex&#8221;]].</li>
<li>The parser MUST define a partial function from public key types to signing algorithms, and this function must at the minimum include the following mappings:  <dl>
<dt>RSA, 2048 bits:</dt>
<dd style="margin-left: 8">rsa_pss_sha256 as defined in Section 4.2.3 of <a href="#TLS1.3" class="xref">[TLS1.3]</a>
</dd>
<dt>EC, with the secp256r1 curve:</dt>
<dd style="margin-left: 8">ecdsa_secp256r1_sha256 as defined in Section 4.2.3 of <a href="#TLS1.3" class="xref">[TLS1.3]</a>
</dd>
<dt>EC, with the secp384r1 curve:</dt>
<dd style="margin-left: 8">ecdsa_secp384r1_sha384 as defined in Section 4.2.3 of <a href="#TLS1.3" class="xref">[TLS1.3]</a>
</dd>
</dl>
<p> Let </p>
<em>signing-alg</em> be the result of applying this function to the key type in <em>certificate</em>&#8217;s Subject Public Key Info. If the function is undefined on this input, the parser MUST continue to the next <em>signature</em>.</li>
<li>Use <em>signing-alg</em> to verify that <em>signature</em>[&#8220;signature&#8221;] is <em>message</em>&#8217;s signature by <em>certificate</em>&#8217;s public key. If it&#8217;s not, the parser MUST continue to the next <em>signature</em>.</li>
<li>Append <em>certificate</em> to <em>signing-certificates</em>. Note that failed signatures simply cause their certificate to be ignored, so that packagers can give new signature types to parsers that understand them.</li>
</ol>
<p id="rfc.section.2.4.p.11">Let <em>origin</em> be <samp>manifest</samp>[&#8220;metadata&#8221;][&#8220;origin&#8221;].</p>
<p id="rfc.section.2.4.p.12">Iterate through <em>signing-certificates</em> until one is found that has an identity (<a href="#RFC2818" class="xref">[RFC2818]</a>, Section 3.1) matching <em>origin</em>&#8217;s hostname, and that is trusted for serverAuth (<a href="#RFC5280" class="xref">[RFC5280]</a>, Section 4.2.1.12) using paths built from elements of <samp>certificates</samp> or any other certificates the parser is aware of. If no such certificate is found, and the package is not already trusted as received from <em>origin</em>&#8217;s hostname, for example because it was received over a TLS connection to that host, then parsing MUST fail.</p>
<p><strong>TODO:</strong> Process the <samp>subpackages</samp> item by fetching those manifests via the index, and checking their signatures and dates/hashes, recursively.</p>
<p id="rfc.section.2.4.p.14">The parsed manifest consists of the set of <em>signing-certificates</em> and the <samp>manifest</samp> CBOR item. The items in <samp>manifest</samp>[&#8220;metadata&#8221;] SHOULD be interpreted as described in the <a href="#appmanifest" class="xref">[appmanifest]</a> specification.</p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> <a href="#subpackages" id="subpackages">Sub-packages</a>
</h1>
<p id="rfc.section.2.4.1.p.1">A sub-package is represented by a <a href="#manifest" class="xref">Section 2.4</a> file looked up as a <a href="#resource" class="xref">Section 2.5</a> within the <samp>indexed-content</samp> section. The sub-package&#8217;s resources are not otherwise distinguished from the rest of the resources in the package. Sub-packages can form an arbitrarily-deep tree.</p>
<pre>
subpackage = [
  resource: resource-key,
  validation: {
    ? hash: {+ hash-algorithm =&gt; hash-value},
    ? notbefore: time,
  }
]
</pre>
<p id="rfc.section.2.4.1.p.2">There are three possible forms of dependencies on sub-packages, of which we allow two. Because a sub-package&#8217;s manifest is protected by its own signature, if the main package trusts the sub-package&#8217;s server, it could avoid specifying a version of the sub-package at all. However, this opens the main package up to downgrade attacks, where the sub-package is replaced by an older, vulnerable version, so we don&#8217;t allow this option.</p>
<p id="rfc.section.2.4.1.p.3">If the main package wants to load either the sub-package it was built with or any upgrade, it can specify the date of the original sub-package:</p>
<pre>
[32("https://example.com/loginsdk.package"),
 {"notbefore": 1(1486429554)}]
</pre>
<p id="rfc.section.2.4.1.p.4">Constraining packages with their date makes it possible to link together sub-packages with common dependencies, even if the sub-packages were built at different times.</p>
<p id="rfc.section.2.4.1.p.5">If the main package wants to be certain it&#8217;s loading the exact version of a sub-package that it was built with, it can constrain the sub-package with a hash of its manifest:</p>
<pre>
[32("https://example.com/loginsdk.package"),
 {"hash": {"sha256":
     b64'9qg0NGDuhsjeGwrcbaxMKZAvfzAHJ2d8L7NkDzXhgHk='}}]
</pre>
<p id="rfc.section.2.4.1.p.6">Note that because the sub-package may include sub-sub-packages by date, the top package may need to explicitly list those sub-sub-packages&#8217; hashes in order to be completely constrained. For example, if <samp>loginsdk.package</samp> has subpackages of the form:</p>
<pre>
[
  [32("https://other.example.com/helper.package"),
   {"notbefore": 1(1486429554)}]
]
</pre>
<p id="rfc.section.2.4.1.p.7">the top-level package needs to specify:</p>
<pre>
[
  [32("https://example.com/loginsdk.package"),
   {"hash": {"sha256":
        b64'9qg0NGDuhsjeGwrcbaxMKZAvfzAHJ2d8L7NkDzXhgHk='}}],
  [32("https://other.example.com/helper.package"),
   {"hash": {"sha256":
        b64'SG2GjbrpfVCh21HPLMIXD17fHNCst1Gz/MbQOqihG68='}}]
]
</pre>
<p id="rfc.section.2.4.1.p.8">in order to completely constrain all the versions of its dependencies.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#resource" id="resource">Parsing a resource</a>
</h1>
<p id="rfc.section.2.5.p.1">To parse the resource from a <em>package</em> corresponding to a <em>header-list</em>, a parser MUST do the following:</p>
<p id="rfc.section.2.5.p.2">Find the (<em>resource-key</em>, <em>offset</em>, <em>length</em>) triple in <em>package</em>&#8217;s index where <em>resource-key</em> is the same as <em>header-list</em>. If no such triple exists, the parser MUST fail.</p>
<p id="rfc.section.2.5.p.3">Parse one CBOR item starting at <em>offset</em> as the following CDDL:</p>
<pre>
response = [response-headers: http-headers, body: bstr]
</pre>
<p id="rfc.section.2.5.p.4">If the item doesn&#8217;t match the CDDL or it&#8217;s not a Canonical CBOR item (Section 3.9 of <a href="#CBOR" class="xref">[CBOR]</a>), parsing MUST fail.</p>
<p id="rfc.section.2.5.p.5">Decode the <samp>response-headers</samp> field using <a href="#HPACK" class="xref">[HPACK]</a>, with an initially-empty dynamic table. The decoded <samp>response-headers</samp> is a header list (<a href="#HPACK" class="xref">[HPACK]</a>, Section 1.3), an ordered list of name-value pairs.</p>
<p id="rfc.section.2.5.p.6">The parser MUST fail if any of the following is true:</p>
<p></p>

<ol>
<li>HPACK decoding encountered an error.</li>
<li>The first header name within <samp>response-headers</samp> is not &#8220;:status&#8221;, or this pseudo-header&#8217;s value violates a requirement in Section 8.1.2.3 of <a href="#HTTP2" class="xref">[HTTP2]</a>.</li>
<li>Any other header name includes the &#8220;:&#8221; character or is not lower-case ascii (<a href="#HTTP2" class="xref">[HTTP2]</a>, Section 8.1.2).</li>
<li>The <em>header-list</em> contains any header names other than &#8220;:scheme&#8221;, &#8220;:authority&#8221;, &#8220;:path&#8221;, and either <samp>response-headers</samp> has no &#8220;vary&#8221; header (Section 7.1.4 of <a href="#RFC7231" class="xref">[RFC7231]</a>) or these header names aren&#8217;t listed in it.</li>
</ol>
<p id="rfc.section.2.5.p.8">Let <em>origin</em> be the Web Origin <a href="#RFC6454" class="xref">[RFC6454]</a> of <em>header-list</em>&#8217;s &#8220;:scheme&#8221; and &#8220;:authority&#8221; headers.</p>
<p id="rfc.section.2.5.p.9"><a name="hashing-resources"></a>Let <em>resource-bytes</em> be the result of encoding the array of [<em>header-list</em>, <samp>response-headers</samp>, <samp>body</samp>] as Canonical CBOR in the following CDDL schema: <a id="ednote-figure-in-list" class="info">[ednote-figure-in-list]<span class="info">jyasskin: This step would be inside the manifest-only block, but then the code block is rendered out-of-order.</span></a></p>
<pre>
resource-bytes = [
  request: [
    *(header-name: bstr, header-value: bstr)
  ],
  response-headers: [
    *(header-name: bstr, header-value: bstr)
  ],
  response-body: bstr
]
</pre>
<p id="rfc.section.2.5.p.10">Note that this uses the decoded header fields, not the bytes originally included in the package.</p>
<p id="rfc.section.2.5.p.11">The hashed data differs from <a href="#SRI" class="xref">[SRI]</a>, which only hashes the body. Including the headers will usually prevent a package from relying on some of its contents being transferred as normal network responses, unless its author can guarantee the network won&#8217;t change or reorder the headers.</p>
<p id="rfc.section.2.5.p.12">If the <em>package</em> contains a <em>manifest</em>:</p>
<p></p>

<ol>
<li>
<strong>TODO:</strong> Let <em>origin-manifest</em> be the signed manifest for <em>origin</em>, found by searching through <em>manifest</em>&#8217;s subpackages for a matching origin.</li>
<li>Let <em>alg</em> be one of the <samp>hash-algorithm</samp>s within <em>origin-manifest</em>. The parser SHOULD select the most collision-resistant hash algorithm. If the parser also implements <a href="#SRI" class="xref">[SRI]</a>, it SHOULD use the same order as its <samp>getPrioritizedHashFunction()</samp> implementation.</li>
<li>If the digest of <em>resource-bytes</em> using <em>alg</em> does not appear in the <em>origin-manifest</em>&#8217;s <samp>resource-hashes</samp>[<em>alg</em>] array, the parser MUST fail.</li>
</ol>
<p id="rfc.section.2.5.p.14">Return the (decoded <samp>response-headers</samp>, <samp>body</samp>) pair.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#authoring-guidelines" id="authoring-guidelines">Guidelines for package authors</a>
</h1>
<p id="rfc.section.3.p.1">Packages SHOULD consist of a single Canonical CBOR item matching the <samp>webpackage</samp> CDDL rule in <a href="#top-level" class="xref">Section 2.2</a>.</p>
<p id="rfc.section.3.p.2">Every resource&#8217;s hash SHOULD appear in every array within <samp>resource-hashes</samp>: otherwise the set of valid resources will depend on the parser&#8217;s choice of preferred hash algorithm.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">Signature validation is difficult.</p>
<p id="rfc.section.4.p.2">Packages with a valid signature need to be invalidated when either</p>
<p></p>

<ul>
<li>the private key for any certificate in the signature&#8217;s validation chain is leaked, or</li>
<li>a vulnerability is discovered in the package&#8217;s contents.</li>
</ul>
<p id="rfc.section.4.p.4">Because packages are intended to be used offline, it&#8217;s impossible to inject a revocation check into the critical path of using the package, and even in online scenarios, such <a href="https://www.imperialviolet.org/2012/02/05/crlsets.html">revocation checks don&#8217;t actually work</a>.  Instead, package consumers must check for a sufficiently recent set of validation files, consisting of OCSP responses <a href="#RFC6960" class="xref">[RFC6960]</a> and signed package version constraints, for example within the last 7-30 days.  <strong>TODO:</strong> These version constraints aren&#8217;t designed yet.</p>
<p id="rfc.section.4.p.5">Relaxing the requirement to consult DNS when determining authority for an origin means that an attacker who possesses a valid certificate no longer needs to be on-path to redirect traffic to them; instead of modifying DNS, they need only convince the user to visit another Web site, in order to serve packages signed as the target.</p>
<p id="rfc.section.4.p.6">All subpackages that mention a particular origin need to be validated before loading resources from that origin. Otherwise, package A could include package B and an old, vulnerable version of package C that B also depends on. If B&#8217;s dependency isn&#8217;t checked before loading resources from C, A could compromise B.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana-considerations" id="iana-considerations">IANA considerations</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#internet-media-type-registration" id="internet-media-type-registration">Internet Media Type Registration</a>
</h1>
<p id="rfc.section.5.1.p.1">IANA maintains the registry of Internet Media Types <a href="#RFC6838" class="xref">[RFC6838]</a> at <a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>.</p>
<p></p>

<ul>
<li>Type name: application</li>
<li>Subtype name: package+cbor <a id="ednote-mime-naming" class="info">[ednote-mime-naming]<span class="info">jyasskin: I suspect the mime type will need to be a bit longer: application/webpackage+cbor or similar.</span></a>
</li>
<li>Required parameters: N/A</li>
<li>Optional parameters: N/A</li>
<li>Encoding considerations: binary</li>
<li>Security considerations: See <a href="#security" class="xref">Section 4</a> of this document.</li>
<li>Interoperability considerations: N/A</li>
<li>Published specification: This document</li>
<li>Applications that use this media type: None yet, but it is expected that web browsers will use this format.</li>
<li>Fragment identifier considerations: N/A</li>
<li>Additional information:  <ul>
<li>Deprecated alias names for this type: N/A</li>
<li>Magic number(s): 85 48 F0 9F 8C 90 F0 9F 93 A6</li>
<li>File extension(s): .wpk</li>
<li>Macintosh file type code(s): N/A</li>
</ul>
</li>
<li>Person &amp; email address to contact for further information: See the Author&#8217;s Address section of this specification.</li>
<li>Intended usage: COMMON</li>
<li>Restrictions on usage: N/A</li>
<li>Author: See the Author&#8217;s Address section of this specification.</li>
<li>Change controller: The IESG <a href="mailto:iesg@ietf.org">iesg@ietf.org</a>
</li>
<li>Provisional registration? (standards tree only): Not yet.</li>
</ul>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="appmanifest">[appmanifest]</b></td>
<td class="top">
<a>Caceres, M.</a>, <a>Christiansen, K.</a>, <a>Lamouri, M.</a> and <a>A. Kostiainen</a>, "<a href="https://www.w3.org/TR/2017/WD-appmanifest-20170608">Web App Manifest</a>", World Wide Web Consortium WD WD-appmanifest-20170608, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="CBOR">[CBOR]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="CDDL">[CDDL]</b></td>
<td class="top">
<a>Birkholz, H.</a>, <a>Vigano, C.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/draft-greevenbosch-appsawg-cbor-cddl-11">Concise data definition language (CDDL): a notational convention to express CBOR data structures</a>", Internet-Draft draft-greevenbosch-appsawg-cbor-cddl-11, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="HPACK">[HPACK]</b></td>
<td class="top">
<a>Peon, R.</a> and <a>H. Ruellan</a>, "<a href="https://tools.ietf.org/html/rfc7541">HPACK: Header Compression for HTTP/2</a>", RFC 7541, DOI 10.17487/RFC7541, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="HTTP2">[HTTP2]</b></td>
<td class="top">
<a>Belshe, M.</a>, <a>Peon, R.</a> and <a>M. Thomson</a>, "<a href="https://tools.ietf.org/html/rfc7540">Hypertext Transfer Protocol Version 2 (HTTP/2)</a>", RFC 7540, DOI 10.17487/RFC7540, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, DOI 10.17487/RFC2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6454">[RFC6454]</b></td>
<td class="top">
<a>Barth, A.</a>, "<a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>", RFC 6454, DOI 10.17487/RFC6454, December 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6960">[RFC6960]</b></td>
<td class="top">
<a>Santesson, S.</a>, <a>Myers, M.</a>, <a>Ankney, R.</a>, <a>Malpani, A.</a>, <a>Galperin, S.</a> and <a>C. Adams</a>, "<a href="https://tools.ietf.org/html/rfc6960">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>", RFC 6960, DOI 10.17487/RFC6960, June 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7231">[RFC7231]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="SRI">[SRI]</b></td>
<td class="top">
<a>Akhawe, D.</a>, <a>Braun, F.</a>, <a>Marier, F.</a> and <a>J. Weinberger</a>, "<a href="http://www.w3.org/TR/2016/REC-SRI-20160623">Subresource Integrity</a>", World Wide Web Consortium Recommendation REC-SRI-20160623, June 2016.</td>
</tr>
<tr>
<td class="reference"><b id="TLS1.3">[TLS1.3]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-28">The Transport Layer Security (TLS) Protocol Version 1.3</a>", Internet-Draft draft-ietf-tls-tls13-28, March 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.yasskin-webpackage-use-cases">[I-D.yasskin-webpackage-use-cases]</b></td>
<td class="top">
<a>Yasskin, J.</a>, "<a href="https://tools.ietf.org/html/draft-yasskin-webpackage-use-cases-01">Use Cases and Requirements for Web Packages</a>", Internet-Draft draft-yasskin-webpackage-use-cases-01, March 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6838">[RFC6838]</b></td>
<td class="top">
<a>Freed, N.</a>, <a>Klensin, J.</a> and <a>T. Hansen</a>, "<a href="https://tools.ietf.org/html/rfc6838">Media Type Specifications and Registration Procedures</a>", BCP 13, RFC 6838, DOI 10.17487/RFC6838, January 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7233">[RFC7233]</b></td>
<td class="top">
<a>Fielding, R.</a>, <a>Lafon, Y.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7233">Hypertext Transfer Protocol (HTTP/1.1): Range Requests</a>", RFC 7233, DOI 10.17487/RFC7233, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="ServiceWorkers">[ServiceWorkers]</b></td>
<td class="top">
<a>Russell, A.</a>, <a>Song, J.</a>, <a>Archibald, J.</a> and <a>M. Kruisselbrink</a>, "<a href="https://www.w3.org/TR/2016/WD-service-workers-1-20161011">Service Workers 1</a>", World Wide Web Consortium WD WD-service-workers-1-20161011, October 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">Thanks to Adam Langley and Ryan Sleevi for in-depth feedback about the security impact of this proposal.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jeffrey Yasskin</span> 
	  <span class="n hidden">
		<span class="family-name">Yasskin</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jyasskin@chromium.org">jyasskin@chromium.org</a></span>

  </address>
</div>

</body>
</html>

